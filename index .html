<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام حجز صالون الحلاقة</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // الأيقونات
        const Calendar = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>;
        const Users = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>;
        const Scissors = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="6" cy="6" r="3"></circle><circle cx="6" cy="18" r="3"></circle><line x1="20" y1="4" x2="8.12" y2="15.88"></line><line x1="14.47" y1="14.48" x2="20" y2="20"></line><line x1="8.12" y1="8.12" x2="12" y2="12"></line></svg>;
        const MapPin = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>;
        const Phone = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>;
        const User = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>;
        const Trash2 = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>;
        const Plus = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>;
        const LogOut = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>;
        const BarChart = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line></svg>;
        const DollarSign = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>;
        const Settings = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>;
        const Edit = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>;
        const Building = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>;

        // قاعدة البيانات المشتركة
        const useSharedData = () => {
          const [data, setData] = useState({
            barbers: [
              { id: 1, name: 'أحمد محمد', branchId: 1, barberId: 'B001', isActive: true, isManager: false },
              { id: 2, name: 'محمود علي', branchId: 1, barberId: 'B002', isActive: true, isManager: false },
              { id: 3, name: 'خالد حسن', branchId: 2, barberId: 'B003', isActive: true, isManager: false },
              { id: 4, name: 'عمر سعيد', branchId: 2, barberId: 'B004', isActive: true, isManager: false },
              { id: 5, name: 'أحمد المدير', branchId: 1, barberId: 'M001', isActive: true, isManager: true },
              { id: 6, name: 'محمود المدير', branchId: 2, barberId: 'M002', isActive: true, isManager: true }
            ],
            branches: [
              { id: 1, name: 'الفرع الأول - المعادي', location: 'المعادي' },
              { id: 2, name: 'الفرع الثاني - مدينة نصر', location: 'مدينة نصر' }
            ],
            bookings: [
              {
                id: 1,
                barberId: 1,
                barberName: 'أحمد محمد',
                customerName: 'محمد علي',
                phone: '01012345678',
                service: 'قص شعر',
                price: 50,
                date: new Date().toLocaleDateString('ar-EG'),
                time: new Date().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' }),
                isDone: false,
                isDeleted: false,
                isCompletedAndDeleted: false
              },
              {
                id: 2,
                barberId: 2,
                barberName: 'محمود علي',
                customerName: 'أحمد حسن',
                phone: '01123456789',
                service: 'حلاقة ذقن',
                price: 30,
                date: new Date().toLocaleDateString('ar-EG'),
                time: new Date().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' }),
                isDone: false,
                isDeleted: false,
                isCompletedAndDeleted: false
              }
            ],
            services: [
              { id: 1, name: 'قص شعر', price: 50 },
              { id: 2, name: 'حلاقة ذقن', price: 30 },
              { id: 3, name: 'قص وحلاقة', price: 70 }
            ]
          });

          return [data, setData];
        };

        // دوال مساعدة للإحصائيات
        const getBarberStats = (barberId, bookings) => {
          const barberBookings = bookings.filter(b => b.barberId === barberId && !b.isDeleted && !b.isCompletedAndDeleted);
          const doneBookings = bookings.filter(b => b.barberId === barberId && (b.isDone === true || b.isCompletedAndDeleted === true));
          const allBookings = bookings.filter(b => b.barberId === barberId);
          
          return {
            totalBookings: barberBookings.length,
            doneBookings: doneBookings.length,
            totalRevenue: allBookings.reduce((sum, b) => sum + b.price, 0)
          };
        };

        // صفحة إدارة الحلاقين
        const BarberManagement = ({ data, updateData, onBack }) => {
          const [selectedBarber, setSelectedBarber] = useState(null);
          const [showAddBookingForm, setShowAddBookingForm] = useState(false);
          const [newBooking, setNewBooking] = useState({ customerName: '', phone: '', selectedServices: [] });

          const handleAddBooking = (e) => {
            e.preventDefault();
            if (!selectedBarber || newBooking.selectedServices.length === 0) return;
            
            const selectedServices = data.services.filter(s => newBooking.selectedServices.includes(s.id));
            const serviceNames = selectedServices.map(s => s.name).join(' + ');
            const totalPrice = selectedServices.reduce((sum, s) => sum + s.price, 0);
            
            const booking = {
              id: Date.now(),
              barberId: selectedBarber.id,
              barberName: selectedBarber.name,
              customerName: newBooking.customerName,
              phone: newBooking.phone || 'غير محدد',
              service: serviceNames,
              price: totalPrice,
              date: new Date().toLocaleDateString('ar-EG'),
              time: new Date().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' }),
              isDone: false,
              isDeleted: false,
              isCompletedAndDeleted: false
            };

            updateData({ ...data, bookings: [...data.bookings, booking] });
            setNewBooking({ customerName: '', phone: '', selectedServices: [] });
            setShowAddBookingForm(false);
          };

          const toggleService = (serviceId) => {
            setNewBooking(prev => ({
              ...prev,
              selectedServices: prev.selectedServices.includes(serviceId)
                ? prev.selectedServices.filter(id => id !== serviceId)
                : [...prev.selectedServices, serviceId]
            }));
          };

          const handleDeleteBooking = (bookingId) => {
            const updatedBookings = data.bookings.map(booking => {
              if (booking.id === bookingId) {
                if (booking.isDone) {
                  return { ...booking, isCompletedAndDeleted: true, isDone: false, isDeleted: false };
                } else {
                  return { ...booking, isDeleted: true };
                }
              }
              return booking;
            });
            updateData({ ...data, bookings: updatedBookings });
          };

          const handleToggleDone = (bookingId) => {
            const updatedBookings = data.bookings.map(booking => 
              booking.id === bookingId 
                ? { ...booking, isDone: !booking.isDone }
                : booking
            );
            updateData({ ...data, bookings: updatedBookings });
          };

          return (
            <div className="min-h-screen bg-gray-100">
              <div className="bg-indigo-600 text-white p-6 shadow-lg">
                <div className="container mx-auto flex justify-between items-center">
                  <div className="text-right">
                    <h1 className="text-2xl font-bold">إدارة الحلاقين</h1>
                    <p className="text-indigo-100">عرض إحصائيات وإدارة حجوزات الحلاقين</p>
                  </div>
                  <button onClick={onBack} className="flex items-center gap-2 bg-indigo-700 hover:bg-indigo-800 px-4 py-2 rounded-lg transition">
                    <LogOut />
                    رجوع
                  </button>
                </div>
              </div>

              <div className="container mx-auto p-6">
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                  {/* قائمة الحلاقين */}
                  <div className="bg-white rounded-lg shadow-lg p-6">
                    <h2 className="text-2xl font-bold text-gray-800 mb-6 text-right">قائمة الحلاقين</h2>
                    <div className="space-y-4">
                      {data.barbers.map(barber => {
                        const stats = getBarberStats(barber.id, data.bookings);
                        const branch = data.branches.find(b => b.id === barber.branchId);
                        return (
                          <div 
                            key={barber.id} 
                            onClick={() => setSelectedBarber(barber)}
                            className={`p-4 rounded-lg border-2 cursor-pointer transition ${
                              selectedBarber?.id === barber.id 
                                ? 'border-indigo-500 bg-indigo-50' 
                                : 'border-gray-200 hover:border-indigo-300'
                            }`}
                          >
                            <div className="flex justify-between items-start">
                              <div className="text-right flex-1">
                                <h3 className="text-xl font-bold text-gray-800">{barber.name}</h3>
                                <p className="text-gray-600">{barber.barberId} - {branch?.name}</p>
                                <div className="grid grid-cols-2 gap-4 mt-3 text-sm">
                                  <div className="bg-blue-50 p-2 rounded">
                                    <p className="text-blue-600 font-bold">{stats.totalBookings}</p>
                                    <p className="text-gray-600">إجمالي الحجوزات</p>
                                  </div>
                                  <div className="bg-green-50 p-2 rounded">
                                    <p className="text-green-600 font-bold">{stats.totalRevenue} ج.م</p>
                                    <p className="text-gray-600">إجمالي الأرباح</p>
                                  </div>
                                </div>
                              </div>
                              <div className="w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center">
                                <Scissors />
                              </div>
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>

                  {/* تفاصيل الحلاق المختار */}
                  {selectedBarber && (
                    <div className="bg-white rounded-lg shadow-lg p-6">
                      <div className="flex justify-between items-center mb-6">
                        <button 
                          onClick={() => setShowAddBookingForm(!showAddBookingForm)}
                          className="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition"
                        >
                          <Plus />
                          إضافة حجز
                        </button>
                        <h2 className="text-2xl font-bold text-gray-800">تفاصيل {selectedBarber.name}</h2>
                      </div>

                      {showAddBookingForm && (
                        <form onSubmit={handleAddBooking} className="mb-6 p-4 bg-gray-50 rounded-lg">
                          <h3 className="text-lg font-bold mb-4 text-right">إضافة حجز جديد</h3>
                          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="text-right">
                              <label className="block text-gray-700 font-semibold mb-2">اسم العميل</label>
                              <input 
                                type="text" 
                                value={newBooking.customerName} 
                                onChange={(e) => setNewBooking({...newBooking, customerName: e.target.value})} 
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg text-right" 
                                required 
                              />
                            </div>
                            <div className="text-right">
                              <label className="block text-gray-700 font-semibold mb-2">رقم الهاتف</label>
                              <input 
                                type="tel" 
                                value={newBooking.phone} 
                                onChange={(e) => setNewBooking({...newBooking, phone: e.target.value})} 
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg text-right" 
                              />
                            </div>
                            <div className="text-right md:col-span-2">
                              <label className="block text-gray-700 font-semibold mb-2">الخدمات (يمكن اختيار أكثر من خدمة)</label>
                              <div className="space-y-2">
                                {data.services.map(service => {
                                  const isSelected = newBooking.selectedServices.includes(service.id);
                                  return (
                                    <div 
                                      key={service.id}
                                      onClick={() => toggleService(service.id)}
                                      className={`p-3 border-2 rounded-lg cursor-pointer transition ${
                                        isSelected 
                                          ? 'border-blue-500 bg-blue-50' 
                                          : 'border-gray-300 hover:border-gray-400'
                                      }`}
                                    >
                                      <div className="flex justify-between items-center">
                                        <div className={`w-5 h-5 rounded border-2 flex items-center justify-center ${
                                          isSelected 
                                            ? 'bg-blue-500 border-blue-500' 
                                            : 'border-gray-300'
                                        }`}>
                                          {isSelected && <span className="text-white text-sm">✓</span>}
                                        </div>
                                        <div className="text-right">
                                          <p className="font-semibold">{service.name}</p>
                                          <p className="text-sm text-gray-600">{service.price} جنيه</p>
                                        </div>
                                      </div>
                                    </div>
                                  );
                                })}
                              </div>
                              {newBooking.selectedServices.length > 0 && (
                                <div className="mt-3 p-3 bg-green-50 rounded-lg">
                                  <p className="text-sm text-green-700">
                                    <strong>المجموع:</strong> {data.services
                                      .filter(s => newBooking.selectedServices.includes(s.id))
                                      .reduce((sum, s) => sum + s.price, 0)} جنيه
                                  </p>
                                </div>
                              )}
                            </div>
                          </div>
                          <div className="flex gap-4 mt-4">
                            <button type="submit" className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition">
                              إضافة
                            </button>
                            <button 
                              type="button" 
                              onClick={() => setShowAddBookingForm(false)} 
                              className="bg-gray-400 text-white px-6 py-2 rounded-lg hover:bg-gray-500 transition"
                            >
                              إلغاء
                            </button>
                          </div>
                        </form>
                      )}

                      {/* إحصائيات مفصلة */}
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div className="bg-blue-50 p-4 rounded-lg text-center">
                          <BarChart className="w-8 h-8 text-blue-600 mx-auto mb-2" />
                          <p className="text-2xl font-bold text-blue-600">{getBarberStats(selectedBarber.id, data.bookings).totalBookings}</p>
                          <p className="text-sm text-gray-600">إجمالي الحجوزات</p>
                        </div>
                        <div className="bg-green-50 p-4 rounded-lg text-center">
                          <Users className="w-8 h-8 text-green-600 mx-auto mb-2" />
                          <p className="text-2xl font-bold text-green-600">{getBarberStats(selectedBarber.id, data.bookings).doneBookings}</p>
                          <p className="text-sm text-gray-600">الحجوزات المكتملة</p>
                        </div>
                        <div className="bg-purple-50 p-4 rounded-lg text-center">
                          <DollarSign className="w-8 h-8 text-purple-600 mx-auto mb-2" />
                          <p className="text-2xl font-bold text-purple-600">{getBarberStats(selectedBarber.id, data.bookings).totalRevenue}</p>
                          <p className="text-sm text-gray-600">إجمالي الأرباح</p>
                        </div>
                      </div>

                      {/* قائمة حجوزات الحلاق */}
                      <div>
                        <h3 className="text-lg font-bold text-gray-800 mb-4 text-right">حجوزات {selectedBarber.name}</h3>
                        <div className="space-y-3 max-h-96 overflow-y-auto">
                          {data.bookings
                            .filter(b => b.barberId === selectedBarber.id && !b.isDeleted && !b.isCompletedAndDeleted)
                            .sort((a, b) => new Date(b.date.split('/').reverse().join('-')) - new Date(a.date.split('/').reverse().join('-')))
                            .map(booking => (
                            <div key={booking.id} className={`border rounded-lg p-4 hover:shadow-md transition ${booking.isDone ? 'bg-green-50 border-green-200' : 'border-gray-200'}`}>
                              <div className="flex justify-between items-start">
                                <div className="flex gap-2">
                                  <button 
                                    onClick={() => handleToggleDone(booking.id)}
                                    className={`px-3 py-1 rounded-full text-sm font-bold transition ${
                                      booking.isDone 
                                        ? 'bg-green-600 text-white hover:bg-green-700' 
                                        : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                    }`}
                                    title={booking.isDone ? 'تم الحلاقة' : 'لم يتم الحلاقة'}
                                  >
                                    {booking.isDone ? '✓ تم' : 'لم يتم'}
                                  </button>
                                  <button 
                                    onClick={() => handleDeleteBooking(booking.id)}
                                    className="text-red-600 hover:text-red-800 transition p-2 hover:bg-red-50 rounded"
                                    title="حذف الحجز"
                                  >
                                    <Trash2 />
                                  </button>
                                </div>
                                <div className="text-right flex-1">
                                  <h4 className={`font-bold text-lg ${booking.isDone ? 'text-green-800' : 'text-gray-800'}`}>
                                    {booking.customerName}
                                    {booking.isDone && <span className="text-green-600 mr-2">✓</span>}
                                  </h4>
                                  <div className="grid grid-cols-2 gap-2 mt-2 text-sm text-gray-600">
                                    <p><Phone className="w-4 h-4 inline ml-1" />{booking.phone}</p>
                                    <p><Scissors className="w-4 h-4 inline ml-1" />{booking.service}</p>
                                    <p><Calendar className="w-4 h-4 inline ml-1" />{booking.date}</p>
                                    <p className="font-bold text-green-600">{booking.price} جنيه</p>
                                  </div>
                                  <p className="text-xs text-gray-500 mt-2">الوقت: {booking.time}</p>
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            </div>
          );
        };

        // صفحة تسجيل دخول الحلاق
        const BarberLogin = ({ onLogin, barbers, onBack }) => {
          const [name, setName] = useState('');
          const [barberId, setBarberId] = useState('');
          const [error, setError] = useState('');

          const handleLogin = (e) => {
            e.preventDefault();
            const barber = barbers.find(b => b.name === name && b.barberId === barberId);
            if (barber) {
              onLogin(barber);
            } else {
              setError('البيانات غير صحيحة');
            }
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700 flex items-center justify-center p-4">
              <button onClick={onBack} className="fixed top-4 right-4 bg-white text-blue-600 px-4 py-2 rounded-lg font-bold hover:bg-blue-50 transition shadow-lg">
                ← رجوع
              </button>
              <div className="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
                <div className="text-center mb-8">
                  <div className="inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4">
                    <Scissors />
                  </div>
                  <h1 className="text-3xl font-bold text-gray-800">تسجيل دخول الحلاق</h1>
                </div>
                <form onSubmit={handleLogin} className="space-y-6">
                  <div>
                    <label className="block text-gray-700 font-semibold mb-2 text-right">الاسم</label>
                    <input type="text" value={name} onChange={(e) => setName(e.target.value)} className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-right" required />
                  </div>
                  <div>
                    <label className="block text-gray-700 font-semibold mb-2 text-right">رقم الحلاق (ID)</label>
                    <input type="text" value={barberId} onChange={(e) => setBarberId(e.target.value)} className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-right" placeholder="مثال: B001" required />
                  </div>
                  {error && <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded text-right">{error}</div>}
                  <button type="submit" className="w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 transition">دخول</button>
                </form>
                <div className="mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-600 text-right">
                  <p className="font-semibold mb-2">للتجربة استخدم:</p>
                  <p className="mb-2"><strong>حلاق عادي:</strong></p>
                  <p>الاسم: أحمد محمد - ID: B001</p>
                  <p className="mb-2 mt-3"><strong>مدير:</strong></p>
                  <p>الاسم: أحمد المدير - ID: M001</p>
                  <p>الاسم: محمود المدير - ID: M002</p>
                </div>
              </div>
            </div>
          );
        };

        // لوحة تحكم الحلاق
        const BarberDashboard = ({ barber, data, updateData, onLogout, onShowManagement }) => {
          const [showAddForm, setShowAddForm] = useState(false);
          const [showBranchChange, setShowBranchChange] = useState(false);
          const [newBooking, setNewBooking] = useState({ customerName: '', phone: '', selectedServices: [] });

          const branch = data.branches.find(b => b.id === barber.branchId);
          const myBookings = data.bookings.filter(b => b.barberId === barber.id && !b.isDeleted && !b.isCompletedAndDeleted);

          const handleAddBooking = (e) => {
            e.preventDefault();
            if (newBooking.selectedServices.length === 0) return;
            
            const selectedServices = data.services.filter(s => newBooking.selectedServices.includes(s.id));
            const serviceNames = selectedServices.map(s => s.name).join(' + ');
            const totalPrice = selectedServices.reduce((sum, s) => sum + s.price, 0);
            
            const booking = {
              id: Date.now(),
              barberId: barber.id,
              barberName: barber.name,
              customerName: newBooking.customerName,
              phone: newBooking.phone || 'غير محدد',
              service: serviceNames,
              price: totalPrice,
              date: new Date().toLocaleDateString('ar-EG'),
              time: new Date().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' }),
              isDone: false,
              isDeleted: false,
              isCompletedAndDeleted: false
            };

            updateData({ ...data, bookings: [...data.bookings, booking] });
            setNewBooking({ customerName: '', phone: '', selectedServices: [] });
            setShowAddForm(false);
          };

          const toggleService = (serviceId) => {
            setNewBooking(prev => ({
              ...prev,
              selectedServices: prev.selectedServices.includes(serviceId)
                ? prev.selectedServices.filter(id => id !== serviceId)
                : [...prev.selectedServices, serviceId]
            }));
          };

          const handleDeleteBooking = (bookingId) => {
            const updatedBookings = data.bookings.map(booking => {
              if (booking.id === bookingId) {
                if (booking.isDone) {
                  return { ...booking, isCompletedAndDeleted: true, isDone: false, isDeleted: false };
                } else {
                  return { ...booking, isDeleted: true };
                }
              }
              return booking;
            });
            updateData({ ...data, bookings: updatedBookings });
          };

          const handleToggleDone = (bookingId) => {
            const updatedBookings = data.bookings.map(booking => 
              booking.id === bookingId 
                ? { ...booking, isDone: !booking.isDone }
                : booking
            );
            updateData({ ...data, bookings: updatedBookings });
          };

          const handleBranchChange = (newBranchId) => {
            const updatedBarbers = data.barbers.map(b => 
              b.id === barber.id 
                ? { ...b, branchId: newBranchId }
                : b
            );
            updateData({ ...data, barbers: updatedBarbers });
            setShowBranchChange(false);
            alert('تم تغيير الفرع بنجاح!');
          };

          return (
            <div className="min-h-screen bg-gray-100">
              <div className="bg-blue-600 text-white p-6 shadow-lg">
                <div className="container mx-auto flex justify-between items-center">
                  <div className="text-right">
                    <h1 className="text-2xl font-bold">مرحباً، {barber.name}</h1>
                    <p className="text-blue-100">ID: {barber.barberId} - {branch?.name}</p>
                  </div>
                  <div className="flex gap-2">
                    <button 
                      onClick={() => setShowBranchChange(true)}
                      className="flex items-center gap-2 bg-orange-600 hover:bg-orange-700 px-4 py-2 rounded-lg transition"
                    >
                      <Building />
                      تغيير الفرع
                    </button>
                    {barber.isManager && onShowManagement && (
                      <button onClick={onShowManagement} className="flex items-center gap-2 bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg transition">
                        <Settings />
                        إدارة الحلاقين
                      </button>
                    )}
                    <button onClick={onLogout} className="flex items-center gap-2 bg-blue-700 hover:bg-blue-800 px-4 py-2 rounded-lg transition">
                      <LogOut />
                      تسجيل خروج
                    </button>
                  </div>
                </div>
              </div>

              {showBranchChange && (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                  <div className="bg-white rounded-lg shadow-xl p-6 w-full max-w-md">
                    <h3 className="text-xl font-bold text-gray-800 mb-4 text-right">تغيير الفرع</h3>
                    <p className="text-gray-600 mb-4 text-right">اختر الفرع الذي تريد العمل به:</p>
                    <div className="space-y-3">
                      {data.branches.map(branchItem => (
                        <button
                          key={branchItem.id}
                          onClick={() => handleBranchChange(branchItem.id)}
                          className={`w-full p-4 text-right rounded-lg border-2 transition ${
                            barber.branchId === branchItem.id
                              ? 'border-blue-500 bg-blue-50 text-blue-700'
                              : 'border-gray-300 hover:border-blue-300'
                          }`}
                        >
                          <div className="flex justify-between items-center">
                            <Building className="w-5 h-5" />
                            <div>
                              <p className="font-bold">{branchItem.name}</p>
                              <p className="text-sm text-gray-600">{branchItem.location}</p>
                            </div>
                          </div>
                        </button>
                      ))}
                    </div>
                    <button
                      onClick={() => setShowBranchChange(false)}
                      className="w-full mt-4 bg-gray-400 text-white py-2 rounded-lg hover:bg-gray-500 transition"
                    >
                      إلغاء
                    </button>
                  </div>
                </div>
              )}

              <div className="container mx-auto p-6">
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                  <div className="bg-white rounded-lg shadow-lg p-6 text-right">
                    <div className="flex justify-between items-center mb-2">
                      <Users />
                      <h3 className="text-gray-600 font-semibold">إجمالي الحجوزات</h3>
                    </div>
                    <p className="text-4xl font-bold text-blue-600">{getBarberStats(barber.id, data.bookings).totalBookings}</p>
                    <p className="text-sm text-gray-500">حجز</p>
                  </div>

                  <div className="bg-white rounded-lg shadow-lg p-6 text-right">
                    <div className="flex justify-between items-center mb-2">
                      <BarChart />
                      <h3 className="text-gray-600 font-semibold">الحجوزات المكتملة</h3>
                    </div>
                    <p className="text-4xl font-bold text-green-600">{getBarberStats(barber.id, data.bookings).doneBookings}</p>
                    <p className="text-sm text-gray-500">حجز مكتمل</p>
                  </div>

                  <div className="bg-white rounded-lg shadow-lg p-6 text-right">
                    <div className="flex justify-between items-center mb-2">
                      <DollarSign />
                      <h3 className="text-gray-600 font-semibold">إجمالي الأرباح</h3>
                    </div>
                    <p className="text-4xl font-bold text-purple-600">{getBarberStats(barber.id, data.bookings).totalRevenue}</p>
                    <p className="text-sm text-gray-500">جنيه مصري</p>
                  </div>

                  <div className="bg-white rounded-lg shadow-lg p-6 text-right">
                    <div className="flex justify-between items-center mb-2">
                      <MapPin />
                      <h3 className="text-gray-600 font-semibold">الفرع</h3>
                    </div>
                    <p className="text-xl font-bold text-orange-600">{branch?.location}</p>
                    <p className="text-sm text-gray-500">{branch?.name}</p>
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-lg p-6">
                  <div className="flex justify-between items-center mb-6">
                    <button onClick={() => setShowAddForm(!showAddForm)} className="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                      <Plus />
                      إضافة حجز جديد
                    </button>
                    <h2 className="text-2xl font-bold text-gray-800">حجوزاتي ({myBookings.length})</h2>
                  </div>

                  {showAddForm && (
                    <form onSubmit={handleAddBooking} className="mb-6 p-6 bg-gray-50 rounded-lg">
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="text-right">
                          <label className="block text-gray-700 font-semibold mb-2">اسم العميل</label>
                          <input type="text" value={newBooking.customerName} onChange={(e) => setNewBooking({...newBooking, customerName: e.target.value})} className="w-full px-4 py-2 border border-gray-300 rounded-lg text-right" required />
                        </div>
                        <div className="text-right">
                          <label className="block text-gray-700 font-semibold mb-2">رقم الهاتف (اختياري)</label>
                          <input type="tel" value={newBooking.phone} onChange={(e) => setNewBooking({...newBooking, phone: e.target.value})} className="w-full px-4 py-2 border border-gray-300 rounded-lg text-right" />
                        </div>
                        <div className="text-right">
                          <label className="block text-gray-700 font-semibold mb-2">الخدمات (يمكن اختيار أكثر من خدمة)</label>
                          <div className="space-y-2">
                            {data.services.map(service => {
                              const isSelected = newBooking.selectedServices.includes(service.id);
                              return (
                                <div 
                                  key={service.id}
                                  onClick={() => toggleService(service.id)}
                                  className={`p-3 border-2 rounded-lg cursor-pointer transition ${
                                    isSelected 
                                      ? 'border-blue-500 bg-blue-50' 
                                      : 'border-gray-300 hover:border-gray-400'
                                  }`}
                                >
                                  <div className="flex justify-between items-center">
                                    <div className={`w-5 h-5 rounded border-2 flex items-center justify-center ${
                                      isSelected 
                                        ? 'bg-blue-500 border-blue-500' 
                                        : 'border-gray-300'
                                    }`}>
                                      {isSelected && <span className="text-white text-sm">✓</span>}
                                    </div>
                                    <div className="text-right">
                                      <p className="font-semibold">{service.name}</p>
                                      <p className="text-sm text-gray-600">{service.price} جنيه</p>
                                    </div>
                                  </div>
                                </div>
                              );
                            })}
                          </div>
                          {newBooking.selectedServices.length > 0 && (
                            <div className="mt-3 p-3 bg-green-50 rounded-lg">
                              <p className="text-sm text-green-700">
                                <strong>المجموع:</strong> {data.services
                                  .filter(s => newBooking.selectedServices.includes(s.id))
                                  .reduce((sum, s) => sum + s.price, 0)} جنيه
                              </p>
                            </div>
                          )}
                        </div>
                      </div>
                      <div className="flex gap-4 mt-4">
                        <button type="submit" className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition">إضافة</button>
                        <button type="button" onClick={() => setShowAddForm(false)} className="bg-gray-400 text-white px-6 py-2 rounded-lg hover:bg-gray-500 transition">إلغاء</button>
                      </div>
                    </form>
                  )}

                  <div className="space-y-4">
                    {myBookings.length === 0 ? (
                      <p className="text-center text-gray-500 py-8">لا توجد حجوزات حتى الآن</p>
                    ) : (
                      myBookings.map(booking => (
                        <div key={booking.id} className={`border rounded-lg p-4 hover:shadow-md transition ${booking.isDone ? 'bg-green-50 border-green-200' : 'border-gray-200'}`}>
                          <div className="flex justify-between items-start">
                            <div className="flex gap-2">
                              <button 
                                onClick={() => handleToggleDone(booking.id)}
                                className={`px-3 py-1 rounded-full text-sm font-bold transition ${
                                  booking.isDone 
                                    ? 'bg-green-600 text-white hover:bg-green-700' 
                                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                }`}
                                title={booking.isDone ? 'تم الحلاقة' : 'لم يتم الحلاقة'}
                              >
                                {booking.isDone ? '✓ تم' : 'لم يتم'}
                              </button>
                              <button 
                                onClick={() => {
                                  if (window.confirm('هل أنت متأكد من حذف هذا الحجز؟')) {
                                    handleDeleteBooking(booking.id);
                                  }
                                }} 
                                className="text-red-600 hover:text-red-800 transition p-2 hover:bg-red-50 rounded"
                                title="حذف الحجز"
                              >
                                <Trash2 />
                              </button>
                            </div>
                            <div className="text-right flex-1">
                              <h3 className={`font-bold text-lg ${booking.isDone ? 'text-green-800' : 'text-gray-800'}`}>
                                {booking.customerName}
                                {booking.isDone && <span className="text-green-600 mr-2">✓</span>}
                              </h3>
                              <div className="grid grid-cols-2 gap-2 mt-2 text-sm text-gray-600">
                                <p><Phone className="w-4 h-4 inline ml-1" />{booking.phone}</p>
                                <p><Scissors className="w-4 h-4 inline ml-1" />{booking.service}</p>
                                <p><Calendar className="w-4 h-4 inline ml-1" />{booking.date}</p>
                                <p className="font-bold text-green-600">{booking.price} جنيه</p>
                              </div>
                              <p className="text-xs text-gray-500 mt-2">الوقت: {booking.time}</p>
                            </div>
                          </div>
                        </div>
                      ))
                    )}
                  </div>
                </div>
              </div>
            </div>
          );
        };

        // صفحة تسجيل العميل
        const CustomerRegistration = ({ onRegister }) => {
          const [customerData, setCustomerData] = useState({ name: '', phone: '' });
          const [phoneError, setPhoneError] = useState('');

          const validatePhone = (phone) => {
            if (phone.length !== 11) {
              return 'رقم الهاتف يجب أن يكون 11 رقم';
            }
            
            if (!phone.startsWith('01')) {
              return 'رقم الهاتف يجب أن يبدأ بـ 01';
            }
            
            const thirdDigit = phone.charAt(2);
            if (!['0', '1', '2', '5'].includes(thirdDigit)) {
              return 'رقم الهاتف غير صحيح. الرقم الثالث يجب أن يكون 0 أو 1 أو 2 أو 5';
            }
            
            return '';
          };

          const handlePhoneChange = (e) => {
            const phone = e.target.value.replace(/\D/g, '');
            setCustomerData({...customerData, phone: phone});
            
            if (phone.length > 0) {
              const error = validatePhone(phone);
              setPhoneError(error);
            } else {
              setPhoneError('');
            }
          };

          const handleSubmit = (e) => {
            e.preventDefault();
            const error = validatePhone(customerData.phone);
            
            if (error) {
              setPhoneError(error);
              return;
            }
            
            onRegister(customerData);
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-purple-900 via-purple-800 to-pink-700 flex items-center justify-center p-4">
              <div className="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
                <div className="text-center mb-8">
                  <div className="inline-flex items-center justify-center w-16 h-16 bg-purple-600 rounded-full mb-4">
                    <Scissors />
                  </div>
                  <h1 className="text-3xl font-bold text-gray-800">مرحباً بك</h1>
                  <p className="text-gray-600 mt-2">سجل بياناتك للحجز</p>
                </div>

                <form onSubmit={handleSubmit} className="space-y-6">
                  <div>
                    <label className="block text-gray-700 font-semibold mb-2 text-right">الاسم</label>
                    <input 
                      type="text" 
                      value={customerData.name} 
                      onChange={(e) => setCustomerData({...customerData, name: e.target.value})} 
                      className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none text-right" 
                      required 
                    />
                  </div>
                  
                  <div>
                    <label className="block text-gray-700 font-semibold mb-2 text-right">رقم الهاتف</label>
                    <input 
                      type="tel" 
                      value={customerData.phone} 
                      onChange={handlePhoneChange}
                      className={`w-full px-4 py-3 border-2 rounded-lg focus:outline-none text-right ${
                        phoneError ? 'border-red-500 focus:border-red-500' : 'border-gray-300 focus:border-purple-500'
                      }`}
                      placeholder="01XXXXXXXXX" 
                      required 
                      maxLength="11"
                    />
                    {phoneError && (
                      <p className="text-red-600 text-sm mt-2 text-right">{phoneError}</p>
                    )}
                    <div className="mt-2 text-sm text-gray-500 text-right">
                      <p>أمثلة صحيحة:</p>
                      <p className="text-xs">• 010xxxxxxxx (فودافون)</p>
                      <p className="text-xs">• 011xxxxxxxx (اتصالات)</p>
                      <p className="text-xs">• 012xxxxxxxx (أورانج)</p>
                      <p className="text-xs">• 015xxxxxxxx (WE)</p>
                    </div>
                  </div>
                  
                  <button 
                    type="submit" 
                    disabled={phoneError !== ''}
                    className="w-full bg-purple-600 text-white py-3 rounded-lg font-bold hover:bg-purple-700 transition duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed"
                  >
                    التالي
                  </button>
                </form>
              </div>
            </div>
          );
        };

        // صفحة الحجز للعميل
        const CustomerBooking = ({ customer, data, updateData, onLogout }) => {
          const [selectedBranch, setSelectedBranch] = useState(null);
          const [selectedBarber, setSelectedBarber] = useState(null);
          const [selectedServices, setSelectedServices] = useState([]);

          const getBarbersInBranch = (branchId) => {
            return data.barbers.filter(b => b.branchId === branchId);
          };

          const getBarberBookingsCount = (barberId) => {
            return data.bookings.filter(b => b.barberId === barberId && !b.isDone && !b.isDeleted && !b.isCompletedAndDeleted).length;
          };

          const toggleService = (service) => {
            if (selectedServices.find(s => s.id === service.id)) {
              setSelectedServices(selectedServices.filter(s => s.id !== service.id));
            } else {
              setSelectedServices([...selectedServices, service]);
            }
          };

          const getTotalPrice = () => {
            return selectedServices.reduce((sum, service) => sum + service.price, 0);
          };

          const handleBooking = () => {
            if (!selectedBarber || selectedServices.length === 0) {
              alert('الرجاء اختيار الحلاق والخدمات');
              return;
            }

            const serviceNames = selectedServices.map(s => s.name).join(' + ');
            const totalPrice = getTotalPrice();

            const booking = {
              id: Date.now(),
              barberId: selectedBarber.id,
              barberName: selectedBarber.name,
              customerName: customer.name,
              phone: customer.phone,
              service: serviceNames,
              price: totalPrice,
              date: new Date().toLocaleDateString('ar-EG'),
              time: new Date().toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' }),
              isDone: false,
              isDeleted: false,
              isCompletedAndDeleted: false
            };

            updateData({ ...data, bookings: [...data.bookings, booking] });
            alert('تم الحجز بنجاح!');
            setSelectedBranch(null);
            setSelectedBarber(null);
            setSelectedServices([]);
            setTimeout(() => {
              onLogout();
            }, 2000);
          };

          return (
            <div className="min-h-screen bg-gray-100">
              <div className="bg-purple-600 text-white p-6 shadow-lg">
                <div className="container mx-auto flex justify-between items-center">
                  <div className="text-right">
                    <h1 className="text-2xl font-bold">مرحباً، {customer.name}</h1>
                    <p className="text-purple-100">{customer.phone}</p>
                  </div>
                  <button onClick={onLogout} className="flex items-center gap-2 bg-purple-700 hover:bg-purple-800 px-4 py-2 rounded-lg transition">
                    <LogOut />
                    تسجيل خروج
                  </button>
                </div>
              </div>

              <div className="container mx-auto p-6">
                <h2 className="text-3xl font-bold text-gray-800 mb-8 text-right">اختر الفرع</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                  {data.branches.map(branch => (
                    <div key={branch.id} onClick={() => setSelectedBranch(branch)} className={`bg-white rounded-lg shadow-lg p-6 cursor-pointer transition transform hover:scale-105 ${selectedBranch?.id === branch.id ? 'ring-4 ring-purple-500' : ''}`}>
                      <div className="text-right">
                        <h3 className="text-2xl font-bold text-gray-800 mb-2">{branch.name}</h3>
                        <p className="text-gray-600 flex items-center justify-end gap-2">
                          <span>{branch.location}</span>
                          <MapPin />
                        </p>
                        <p className="text-purple-600 font-bold mt-4">{getBarbersInBranch(branch.id).length} حلاق متاح</p>
                      </div>
                    </div>
                  ))}
                </div>

                {selectedBranch && (
                  <>
                    <h2 className="text-3xl font-bold text-gray-800 mb-8 text-right">اختر الحلاق</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                      {getBarbersInBranch(selectedBranch.id).map(barber => {
                        const bookingsCount = getBarberBookingsCount(barber.id);
                        return (
                          <div key={barber.id} onClick={() => setSelectedBarber(barber)} className={`bg-white rounded-lg shadow-lg p-6 cursor-pointer transition transform hover:scale-105 ${selectedBarber?.id === barber.id ? 'ring-4 ring-purple-500' : ''}`}>
                            <div className="text-right">
                              <div className="flex justify-end items-center gap-3 mb-4">
                                <div>
                                  <h3 className="text-xl font-bold text-gray-800">{barber.name}</h3>
                                </div>
                                <div className="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center">
                                  <Scissors />
                                </div>
                              </div>
                              <div className="bg-purple-50 rounded-lg p-3 text-center">
                                <p className="text-2xl font-bold text-purple-600">{bookingsCount}</p>
                                <p className="text-sm text-gray-600">عميل في الانتظار</p>
                              </div>
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </>
                )}

                {selectedBarber && (
                  <>
                    <h2 className="text-3xl font-bold text-gray-800 mb-4 text-right">اختر الخدمات</h2>
                    <p className="text-gray-600 mb-8 text-right">يمكنك اختيار أكثر من خدمة</p>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                      {data.services.map(service => {
                        const isSelected = selectedServices.find(s => s.id === service.id);
                        return (
                          <div 
                            key={service.id} 
                            onClick={() => toggleService(service)} 
                            className={`bg-white rounded-lg shadow-lg p-6 cursor-pointer transition transform hover:scale-105 ${isSelected ? 'ring-4 ring-purple-500 bg-purple-50' : ''}`}
                          >
                            <div className="text-right">
                              <div className="flex justify-between items-start mb-2">
                                <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${isSelected ? 'bg-purple-600 border-purple-600' : 'border-gray-300'}`}>
                                  {isSelected && <span className="text-white text-sm">✓</span>}
                                </div>
                                <h3 className="text-xl font-bold text-gray-800">{service.name}</h3>
                              </div>
                              <p className="text-3xl font-bold text-purple-600">{service.price} جنيه</p>
                            </div>
                          </div>
                        );
                      })}
                    </div>

                    {selectedServices.length > 0 && (
                      <div className="bg-white rounded-lg shadow-lg p-8 text-right">
                        <h3 className="text-2xl font-bold text-gray-800 mb-4">ملخص الحجز</h3>
                        <div className="space-y-3 text-lg">
                          <p><strong>الفرع:</strong> {selectedBranch.name}</p>
                          <p><strong>الحلاق:</strong> {selectedBarber.name}</p>
                          <div>
                            <p className="font-bold mb-2">الخدمات المختارة:</p>
                            <ul className="mr-6 space-y-1">
                              {selectedServices.map(service => (
                                <li key={service.id} className="text-gray-700">
                                  • {service.name} - {service.price} جنيه
                                </li>
                              ))}
                            </ul>
                          </div>
                          <p className="text-2xl"><strong>إجمالي السعر:</strong> <span className="text-purple-600 font-bold">{getTotalPrice()} جنيه</span></p>
                          <p className="text-purple-600"><strong>الانتظار المتوقع:</strong> {getBarberBookingsCount(selectedBarber.id)} عميل</p>
                        </div>
                        <button onClick={handleBooking} className="w-full bg-purple-600 text-white py-4 rounded-lg font-bold text-xl hover:bg-purple-700 transition mt-6">
                          تأكيد الحجز
                        </button>
                      </div>
                    )}
                  </>
                )}
              </div>
            </div>
          );
        };

        // المكون الرئيسي
        const App = () => {
          const [data, updateData] = useSharedData();
          const [showBarberAccess, setShowBarberAccess] = useState(false);
          const [showBarberManagement, setShowBarberManagement] = useState(false);
          const [loggedInBarber, setLoggedInBarber] = useState(null);
          const [loggedInCustomer, setLoggedInCustomer] = useState(null);

          if (showBarberManagement) {
            return (
              <BarberManagement
                data={data}
                updateData={updateData}
                onBack={() => setShowBarberManagement(false)}
              />
            );
          }

          if (showBarberAccess) {
            if (!loggedInBarber) {
              return (
                <BarberLogin 
                  onLogin={setLoggedInBarber} 
                  barbers={data.barbers}
                  onBack={() => setShowBarberAccess(false)}
                />
              );
            }
            return (
              <BarberDashboard
                barber={loggedInBarber}
                data={data}
                updateData={updateData}
                onLogout={() => {
                  setLoggedInBarber(null);
                  setShowBarberAccess(false);
                }}
                onShowManagement={() => {
                  setShowBarberManagement(true);
                  setShowBarberAccess(false);
                }}
              />
            );
          }

          if (!loggedInCustomer) {
            return (
              <div>
                <CustomerRegistration onRegister={setLoggedInCustomer} />
                <button
                  onClick={() => setShowBarberAccess(true)}
                  className="fixed bottom-4 left-4 w-12 h-12 bg-gray-800 bg-opacity-50 rounded-full flex items-center justify-center hover:bg-opacity-70 transition"
                  title="دخول الحلاق"
                >
                  <Scissors className="w-6 h-6 text-gray-300" />
                </button>
              </div>
            );
          }

          return (
            <CustomerBooking
              customer={loggedInCustomer}
              data={data}
              updateData={updateData}
              onLogout={() => setLoggedInCustomer(null)}
            />
          );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>